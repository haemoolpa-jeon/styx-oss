# 🎵 Styx

HADES를 위한 실시간 오디오 협업 플랫폼

## 기능

### 오디오
- **실시간 P2P 오디오** - WebRTC 기반 저지연 스트리밍
- **최대 8명** - 방당 최대 8명 동시 접속
- **TURN 서버** - NAT/방화벽 뒤에서도 안정적 연결
- **개별 볼륨 조절** - 사용자별 볼륨/팬/뮤트/솔로
- **음성/음악 모드** - 용도에 맞는 오디오 최적화
- **3밴드 EQ** - 저음/중음/고음 조절
- **입력 리미터** - 클리핑 방지

### 녹음
- **믹스다운 녹음** - 전체 오디오를 하나의 파일로
- **멀티트랙 녹음** - 각 참가자별 개별 파일 저장

### 화면 공유
- **악보/가사 공유** - 화면 공유로 악보 표시
- **실시간 표시** - 모든 참가자에게 동시 표시

### 역할 시스템
- **호스트** - 방 생성자, 역할 변경 권한
- **연주자** - 오디오 송수신 가능
- **청취자** - 수신만 가능 (음소거 고정)

### 네트워크
- **연결 테스트** - 마이크/스피커/네트워크 품질 측정
- **Wi-Fi 경고** - 유선 연결 권장 메시지
- **자동 지터 버퍼** - 네트워크 상태에 따라 자동 조절
- **연결 유형 표시** - 직접/STUN/TURN 연결 상태

### 메트로놈
- **공유 메트로놈** - 방 전체 BPM 동기화
- **서버 시간 동기화** - 정확한 박자 맞춤
- **카운트인** - 4박 카운트 후 시작

### 사용자 관리
- **회원가입/로그인** - bcrypt 암호화
- **관리자 승인** - 가입 요청 승인/거절
- **아바타** - 프로필 이미지 업로드

### 방 기능
- **방 브라우저** - 활성 방 목록
- **비공개 방** - 비밀번호 설정
- **채팅** - 방 내 텍스트 채팅

## 빠른 시작

```bash
git clone https://github.com/haemoolpa-jeon/styx.git
cd styx
npm install
npm run setup    # 관리자 계정 생성
npm start        # 서버 시작
```

브라우저에서 `http://localhost:3000` 접속

**기본 관리자**: `admin` / `admin123` (첫 로그인 후 변경 필수!)

## 서버 주소

- **웹**: https://3-39-223-2.nip.io
- **TURN**: 3.39.223.2:3478

## 키보드 단축키

| 키 | 기능 |
|----|------|
| M | 음소거 토글 |
| Space | 메트로놈 시작/정지 |
| R | 녹음 시작/정지 |
| I | 초대 링크 복사 |
| Esc | 방 나가기 |
| 1-8 | 해당 피어 음소거 |

## 파일 구조

```
styx/
├── server/index.js       # 시그널링 서버
├── shared/client/        # 공유 클라이언트 코드
├── client/config.js      # 웹 버전 설정
├── styx-desktop/         # Tauri 데스크톱 앱
├── docs/                 # 문서
└── .env.example          # 환경변수 예시
```

## 아키텍처

```
┌─────────┐                           ┌─────────┐
│ User A  │◄──── WebRTC P2P 오디오 ───►│ User B  │
└────┬────┘                           └────┬────┘
     │                                      │
     │    ┌─────────────────────────┐      │
     └───►│   Styx 서버 (서울)       │◄─────┘
          │  • Socket.IO 시그널링    │
          │  • 방/채팅/메트로놈       │
          │  • TURN 자격증명 발급    │
          └───────────┬─────────────┘
                      │
          ┌───────────▼─────────────┐
          │   Coturn TURN 서버      │
          │  • NAT 통과 릴레이       │
          │  • UDP/TCP 3478         │
          └─────────────────────────┘
```

## 문서

- [사용 설명서](docs/USER_MANUAL.md)
- [배포 가이드](docs/AWS_LIGHTSAIL_DEPLOY.md)
- [테스트 가이드](docs/TESTING_GUIDE.md)
- [HADES 소개](docs/HADES_STYX_소개.md)

## 라이선스

HADES 전용 - 비공개 사용
