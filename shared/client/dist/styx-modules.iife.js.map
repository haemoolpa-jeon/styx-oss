{"version":3,"file":"styx-modules.iife.js","sources":["../modules/core.js","../modules/ui.js","../modules/settings.js","../modules/audio.js","../modules/recording.js","../modules/network.js","../main.js"],"sourcesContent":["// Styx - Shared State & Utilities\n// Core state that all modules need access to\n\nexport const DEBUG = location.hostname === 'localhost' || location.hostname === '127.0.0.1';\nexport const log = (...args) => DEBUG && console.log(...args);\nexport const $ = id => document.getElementById(id);\n\nexport const serverUrl = window.STYX_SERVER_URL || '';\n\n// Tauri detection\nexport const isTauriApp = () => {\n  if (navigator.userAgent.includes('Tauri')) return true;\n  if (typeof window.__TAURI__ !== 'undefined') return true;\n  if (typeof window.__TAURI_INTERNALS__ !== 'undefined') return true;\n  if (location.protocol === 'tauri:') return true;\n  return false;\n};\n\nexport const actuallyTauri = isTauriApp();\nexport const tauriInvoke = actuallyTauri ? (window.__TAURI__?.core?.invoke || null) : null;\n\n// Shared state object - modules import and modify this\nexport const state = {\n  // User & Room\n  currentUser: null,\n  myRole: 'performer',\n  currentRoomSettings: {},\n  isRoomCreator: false,\n  roomCreatorUsername: '',\n  \n  // Audio\n  localStream: null,\n  processedStream: null,\n  isMuted: false,\n  selectedDeviceId: null,\n  selectedOutputId: null,\n  \n  // Peers\n  peers: new Map(),\n  volumeStates: new Map(),\n  \n  // Recording\n  isRecording: false,\n  mediaRecorder: null,\n  recordedChunks: [],\n  multitrackMode: localStorage.getItem('styx-multitrack') === 'true',\n  loopbackMode: localStorage.getItem('styx-loopback') === 'true',\n  \n  // Settings\n  proMode: localStorage.getItem('styx-pro-mode') === 'true',\n  lowLatencyMode: localStorage.getItem('styx-low-latency') === 'true',\n  autoJitter: localStorage.getItem('styx-auto-jitter') !== 'false',\n  vadEnabled: localStorage.getItem('styx-vad') !== 'false',\n  duckingEnabled: localStorage.getItem('styx-ducking') === 'true',\n};\n\n// Avatar URL helper\nexport const avatarUrl = (path) => path ? (path.startsWith('/') ? serverUrl + path : path) : '';\n","// Styx - UI Module\n// DOM helpers, modals, toasts, theme\n\nimport { $, state } from './core.js';\n\n// Toast notifications\nexport function toast(message, type = 'info', duration = 3000) {\n  const container = $('toast-container');\n  if (!container) return;\n  const el = document.createElement('div');\n  el.className = `toast ${type}`;\n  el.textContent = message;\n  container.appendChild(el);\n  setTimeout(() => {\n    el.classList.add('hide');\n    setTimeout(() => el.remove(), 300);\n  }, duration);\n}\n\n// Theme\nexport function initTheme() {\n  const saved = localStorage.getItem('styx-theme') || 'dark';\n  document.body.dataset.theme = saved;\n  updateThemeIcon();\n}\n\nexport function toggleTheme() {\n  const current = document.body.dataset.theme;\n  const next = current === 'dark' ? 'light' : 'dark';\n  document.body.dataset.theme = next;\n  localStorage.setItem('styx-theme', next);\n  updateThemeIcon();\n}\n\nfunction updateThemeIcon() {\n  const btn = $('themeBtn');\n  if (btn) btn.textContent = document.body.dataset.theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';\n}\n\n// Modal helpers\nexport function showModal(id) {\n  const modal = $(id);\n  if (modal) modal.classList.remove('hidden');\n}\n\nexport function hideModal(id) {\n  const modal = $(id);\n  if (modal) modal.classList.add('hidden');\n}\n\n// Reconnection overlay\nlet reconnectAttempt = 0;\n\nexport function showReconnectProgress(attempt = 1) {\n  reconnectAttempt = attempt;\n  const overlay = $('reconnect-overlay');\n  if (!overlay) return;\n  overlay.classList.remove('hidden');\n  const countEl = $('reconnect-count');\n  if (countEl) countEl.textContent = attempt;\n  const progress = (attempt / 10) * 100;\n  const progressBar = overlay.querySelector('.progress-bar');\n  if (progressBar) progressBar.style.width = progress + '%';\n}\n\nexport function updateReconnectProgress() {\n  const overlay = $('reconnect-overlay');\n  if (!overlay || overlay.classList.contains('hidden')) return;\n  const progress = (reconnectAttempt / 10) * 100;\n  const progressBar = overlay.querySelector('.progress-bar');\n  if (progressBar) progressBar.style.width = progress + '%';\n}\n\nexport function hideReconnectProgress() {\n  const overlay = $('reconnect-overlay');\n  if (overlay) overlay.classList.add('hidden');\n  reconnectAttempt = 0;\n}\n\n// Mute UI update\nexport function updateMuteUI() {\n  const btn = $('muteBtn');\n  if (btn) {\n    btn.textContent = state.isMuted ? 'üîá' : 'üé§';\n    btn.classList.toggle('muted', state.isMuted);\n  }\n}\n\n// Quality indicator\nexport function updateQualityIndicator(jitter = 0, packetLoss = 0, e2eLatency = null) {\n  const indicator = $('quality-indicator');\n  if (!indicator) return;\n  \n  let quality = 'good';\n  if (jitter > 30 || packetLoss > 5) quality = 'fair';\n  if (jitter > 50 || packetLoss > 10) quality = 'poor';\n  \n  indicator.className = `quality-indicator ${quality}`;\n  \n  let title = `Jitter: ${jitter.toFixed(1)}ms\\nPacket Loss: ${packetLoss.toFixed(1)}%`;\n  if (e2eLatency !== null) title += `\\nE2E Latency: ${e2eLatency}ms`;\n  indicator.title = title;\n  \n  const latencyText = indicator.querySelector('.latency-text');\n  if (latencyText && e2eLatency !== null) {\n    latencyText.textContent = `${e2eLatency}ms`;\n  }\n}\n","// Styx - Settings Module\n// All localStorage operations and settings sync\n\nimport { $, state, log } from './core.js';\n\n// Settings keys\nconst KEYS = {\n  theme: 'styx-theme',\n  audioMode: 'styx-audio-mode',\n  jitterBuffer: 'styx-jitter-buffer',\n  autoJitter: 'styx-auto-jitter',\n  lowLatency: 'styx-low-latency',\n  proMode: 'styx-pro-mode',\n  echo: 'styx-echo',\n  noise: 'styx-noise',\n  aiNoise: 'styx-ai-noise',\n  ptt: 'styx-ptt',\n  pttKey: 'styx-ptt-key',\n  ducking: 'styx-ducking',\n  vad: 'styx-vad',\n  autoAdapt: 'styx-auto-adapt',\n  multitrack: 'styx-multitrack',\n  loopback: 'styx-loopback',\n  effects: 'styx-effects',\n  noiseProfile: 'styx-noise-profile',\n  customPresets: 'styx-custom-presets',\n  roomTemplates: 'styx-room-templates',\n  accessibility: 'styx-accessibility',\n  qualityLevel: 'styx-quality-level',\n};\n\n// Default values\nconst DEFAULTS = {\n  audioMode: 'balanced',\n  jitterBuffer: 5,\n  autoJitter: true,\n  lowLatency: false,\n  proMode: false,\n  echo: true,\n  noise: true,\n  aiNoise: false,\n  ptt: false,\n  pttKey: 'Space',\n  ducking: false,\n  vad: true,\n  autoAdapt: true,\n  multitrack: false,\n  loopback: false,\n  qualityLevel: 'auto',\n  effects: { eqLow: 0, eqMid: 0, eqHigh: 0, inputVolume: 120, compressionRatio: 4 },\n};\n\n// Load a setting\nexport function getSetting(key, defaultValue = null) {\n  try {\n    const val = localStorage.getItem(KEYS[key] || key);\n    if (val === null) return defaultValue ?? DEFAULTS[key];\n    if (val === 'true') return true;\n    if (val === 'false') return false;\n    const num = Number(val);\n    if (!isNaN(num) && val.trim() !== '') return num;\n    try { return JSON.parse(val); } catch { return val; }\n  } catch (e) {\n    log('Settings load error:', key, e);\n    return defaultValue ?? DEFAULTS[key];\n  }\n}\n\n// Save a setting\nexport function setSetting(key, value) {\n  try {\n    const storageKey = KEYS[key] || key;\n    if (typeof value === 'object') {\n      localStorage.setItem(storageKey, JSON.stringify(value));\n    } else {\n      localStorage.setItem(storageKey, String(value));\n    }\n  } catch (e) {\n    log('Settings save error:', key, e);\n  }\n}\n\n// Remove a setting\nexport function removeSetting(key) {\n  localStorage.removeItem(KEYS[key] || key);\n}\n\n// Load all settings into state\nexport function loadAllSettings() {\n  state.proMode = getSetting('proMode');\n  state.lowLatencyMode = getSetting('lowLatency');\n  state.autoJitter = getSetting('autoJitter');\n  state.vadEnabled = getSetting('vad');\n  state.duckingEnabled = getSetting('ducking');\n  state.multitrackMode = getSetting('multitrack');\n  state.loopbackMode = getSetting('loopback');\n}\n\n// Collect settings for sync\nexport function collectSettings() {\n  return {\n    audioMode: getSetting('audioMode'),\n    jitterBuffer: getSetting('jitterBuffer'),\n    autoAdapt: getSetting('autoAdapt'),\n    echoCancellation: getSetting('echo'),\n    noiseSuppression: getSetting('noise'),\n    aiNoiseCancellation: getSetting('aiNoise'),\n    pttMode: getSetting('ptt'),\n    pttKey: getSetting('pttKey'),\n    duckingEnabled: getSetting('ducking'),\n    vadEnabled: getSetting('vad'),\n    theme: getSetting('theme') || 'dark',\n  };\n}\n\n// Apply settings from sync\nexport function applySettings(s) {\n  if (!s) return;\n  if (s.audioMode) setSetting('audioMode', s.audioMode);\n  if (s.jitterBuffer !== undefined) setSetting('jitterBuffer', s.jitterBuffer);\n  if (s.autoAdapt !== undefined) setSetting('autoAdapt', s.autoAdapt);\n  if (s.echoCancellation !== undefined) setSetting('echo', s.echoCancellation);\n  if (s.noiseSuppression !== undefined) setSetting('noise', s.noiseSuppression);\n  if (s.aiNoiseCancellation !== undefined) setSetting('aiNoise', s.aiNoiseCancellation);\n  if (s.pttMode !== undefined) setSetting('ptt', s.pttMode);\n  if (s.pttKey) setSetting('pttKey', s.pttKey);\n  if (s.duckingEnabled !== undefined) setSetting('ducking', s.duckingEnabled);\n  if (s.vadEnabled !== undefined) setSetting('vad', s.vadEnabled);\n  if (s.theme) {\n    setSetting('theme', s.theme);\n    document.documentElement.setAttribute('data-theme', s.theme);\n  }\n  loadAllSettings();\n}\n\n// Audio presets\nconst builtInPresets = {\n  voice: { eqLow: -3, eqMid: 2, eqHigh: 1, inputVolume: 130, compressionRatio: 6 },\n  instrument: { eqLow: 0, eqMid: 0, eqHigh: 0, inputVolume: 100, compressionRatio: 2 },\n  podcast: { eqLow: -2, eqMid: 3, eqHigh: 2, inputVolume: 140, compressionRatio: 5 },\n};\n\nexport function getPresets() {\n  const custom = getSetting('customPresets') || {};\n  return { ...builtInPresets, ...custom };\n}\n\nexport function saveCustomPreset(name, settings) {\n  const custom = getSetting('customPresets') || {};\n  custom[name] = settings;\n  setSetting('customPresets', custom);\n}\n\nexport function deleteCustomPreset(name) {\n  const custom = getSetting('customPresets') || {};\n  delete custom[name];\n  setSetting('customPresets', custom);\n}\n\n// Room templates\nexport function getRoomTemplates() {\n  return getSetting('roomTemplates') || {};\n}\n\nexport function saveRoomTemplate(name, template) {\n  const templates = getRoomTemplates();\n  templates[name] = template;\n  setSetting('roomTemplates', templates);\n}\n\nexport function deleteRoomTemplate(name) {\n  const templates = getRoomTemplates();\n  delete templates[name];\n  setSetting('roomTemplates', templates);\n}\n\n// Effects settings\nexport function getEffects() {\n  return getSetting('effects') || DEFAULTS.effects;\n}\n\nexport function setEffects(effects) {\n  setSetting('effects', effects);\n}\n\n// Noise profile\nexport function getNoiseProfile() {\n  return getSetting('noiseProfile') || { baselineLevel: -60, adaptiveThreshold: -45 };\n}\n\nexport function setNoiseProfile(profile) {\n  setSetting('noiseProfile', profile);\n}\n","// Styx - Audio Module\n// Audio processing, effects, meters, spectrum analyzer\n\nimport { $, state, log } from './core.js';\nimport { toast } from './ui.js';\nimport { getEffects, setEffects, getNoiseProfile, setNoiseProfile } from './settings.js';\n\n// Shared AudioContext\nlet sharedAudioContext = null;\n\nexport function getSharedAudioContext() {\n  if (!sharedAudioContext || sharedAudioContext.state === 'closed') {\n    sharedAudioContext = new AudioContext({ latencyHint: 'interactive', sampleRate: 48000 });\n  }\n  if (sharedAudioContext.state === 'suspended') {\n    sharedAudioContext.resume();\n  }\n  return sharedAudioContext;\n}\n\n// Effect nodes\nlet effectNodes = {};\nlet noiseGateWorklet = null;\nlet inputEffects = getEffects();\n\n// Create processed input stream with EQ, compressor, noise gate\nexport async function createProcessedInputStream(rawStream) {\n  if (state.proMode) {\n    state.processedStream = rawStream;\n    effectNodes = {};\n    return rawStream;\n  }\n  \n  const ctx = getSharedAudioContext();\n  const source = ctx.createMediaStreamSource(rawStream);\n  \n  // 3-band EQ\n  const eqLow = ctx.createBiquadFilter();\n  eqLow.type = 'lowshelf'; eqLow.frequency.value = 320; eqLow.gain.value = inputEffects.eqLow;\n  \n  const eqMid = ctx.createBiquadFilter();\n  eqMid.type = 'peaking'; eqMid.frequency.value = 1000; eqMid.Q.value = 1; eqMid.gain.value = inputEffects.eqMid;\n  \n  const eqHigh = ctx.createBiquadFilter();\n  eqHigh.type = 'highshelf'; eqHigh.frequency.value = 3200; eqHigh.gain.value = inputEffects.eqHigh;\n  \n  let lastNode = eqHigh;\n  \n  // AI noise gate (AudioWorklet)\n  const noiseProfile = getNoiseProfile();\n  try {\n    await ctx.audioWorklet.addModule('noise-gate-processor.js');\n    noiseGateWorklet = new AudioWorkletNode(ctx, 'noise-gate-processor');\n    const thresholdParam = noiseGateWorklet.parameters.get('threshold');\n    if (thresholdParam) {\n      thresholdParam.value = noiseProfile.adaptiveThreshold > -60 ? noiseProfile.adaptiveThreshold : -45;\n    }\n    eqHigh.connect(noiseGateWorklet);\n    lastNode = noiseGateWorklet;\n  } catch (e) { log('Noise gate worklet failed:', e); }\n  \n  // Compressor/limiter\n  const compressor = ctx.createDynamicsCompressor();\n  compressor.threshold.value = -12; compressor.knee.value = 6;\n  compressor.ratio.value = inputEffects.compressionRatio || 4;\n  compressor.attack.value = 0.003; compressor.release.value = 0.1;\n  \n  // Makeup gain\n  const makeupGain = ctx.createGain();\n  makeupGain.gain.value = inputEffects.inputVolume / 100;\n  \n  const dest = ctx.createMediaStreamDestination();\n  \n  // Chain: source -> EQ -> [noiseGate] -> compressor -> gain -> dest\n  source.connect(eqLow);\n  eqLow.connect(eqMid);\n  eqMid.connect(eqHigh);\n  lastNode.connect(compressor);\n  compressor.connect(makeupGain);\n  makeupGain.connect(dest);\n  \n  effectNodes = { eqLow, eqMid, eqHigh, compressor, makeupGain, noiseGate: noiseGateWorklet };\n  state.processedStream = dest.stream;\n  return state.processedStream;\n}\n\n// Update effect parameter\nexport function updateInputEffect(effect, value) {\n  inputEffects[effect] = value;\n  setEffects(inputEffects);\n  \n  if (!effectNodes.eqLow) return;\n  \n  switch(effect) {\n    case 'eqLow': effectNodes.eqLow.gain.value = value; break;\n    case 'eqMid': effectNodes.eqMid.gain.value = value; break;\n    case 'eqHigh': effectNodes.eqHigh.gain.value = value; break;\n    case 'inputVolume': \n      if (effectNodes.makeupGain) effectNodes.makeupGain.gain.value = value / 100; \n      break;\n    case 'compressionRatio':\n      if (effectNodes.compressor) effectNodes.compressor.ratio.value = value;\n      state.peers.forEach(peer => {\n        if (peer.compressor) peer.compressor.ratio.value = value;\n      });\n      break;\n  }\n}\n\n// Spectrum analyzer\nlet spectrumAnalyser = null;\nlet spectrumCanvas = null;\nlet spectrumCtx = null;\nlet spectrumAnimationId = null;\nlet spectrumEnabled = false;\n\nexport function initSpectrum() {\n  spectrumCanvas = $('spectrum-canvas');\n  if (spectrumCanvas) spectrumCtx = spectrumCanvas.getContext('2d');\n}\n\nexport function toggleSpectrum() {\n  spectrumEnabled = !spectrumEnabled;\n  const container = $('spectrum-container');\n  \n  if (spectrumEnabled) {\n    container?.classList.remove('hidden');\n    if (state.localStream) startSpectrum();\n  } else {\n    container?.classList.add('hidden');\n    stopSpectrum();\n  }\n}\n\nfunction startSpectrum() {\n  if (!state.localStream || !spectrumCtx) return;\n  \n  const ctx = getSharedAudioContext();\n  spectrumAnalyser = ctx.createAnalyser();\n  spectrumAnalyser.fftSize = 256;\n  spectrumAnalyser.smoothingTimeConstant = 0.8;\n  \n  const source = ctx.createMediaStreamSource(state.localStream);\n  source.connect(spectrumAnalyser);\n  \n  drawSpectrum();\n}\n\nfunction stopSpectrum() {\n  if (spectrumAnimationId) {\n    cancelAnimationFrame(spectrumAnimationId);\n    spectrumAnimationId = null;\n  }\n  if (spectrumAnalyser) {\n    try { spectrumAnalyser.disconnect(); } catch {}\n    spectrumAnalyser = null;\n  }\n}\n\nfunction drawSpectrum() {\n  if (!spectrumEnabled || !spectrumAnalyser || !spectrumCtx) return;\n  \n  const bufferLength = spectrumAnalyser.frequencyBinCount;\n  const dataArray = new Uint8Array(bufferLength);\n  spectrumAnalyser.getByteFrequencyData(dataArray);\n  \n  const width = spectrumCanvas.width;\n  const height = spectrumCanvas.height;\n  \n  spectrumCtx.fillStyle = 'rgba(0, 0, 0, 0.2)';\n  spectrumCtx.fillRect(0, 0, width, height);\n  \n  const barWidth = width / bufferLength * 2;\n  let x = 0;\n  \n  for (let i = 0; i < bufferLength; i++) {\n    const barHeight = (dataArray[i] / 255) * height;\n    const hue = (i / bufferLength) * 240;\n    spectrumCtx.fillStyle = `hsl(${hue}, 70%, 50%)`;\n    spectrumCtx.fillRect(x, height - barHeight, barWidth, barHeight);\n    x += barWidth + 1;\n  }\n  \n  spectrumAnimationId = requestAnimationFrame(drawSpectrum);\n}\n\n// Audio meter\nlet meterInterval = null;\nlet analyser = null;\n\nexport function startAudioMeter() {\n  if (!state.localStream) return;\n  \n  const ctx = getSharedAudioContext();\n  analyser = ctx.createAnalyser();\n  analyser.fftSize = 256;\n  \n  const source = ctx.createMediaStreamSource(state.localStream);\n  source.connect(analyser);\n  \n  const dataArray = new Uint8Array(analyser.frequencyBinCount);\n  \n  meterInterval = setInterval(() => {\n    analyser.getByteFrequencyData(dataArray);\n    let sum = 0;\n    for (let i = 0; i < dataArray.length; i++) sum += dataArray[i];\n    const avg = sum / dataArray.length;\n    const level = Math.min(100, (avg / 128) * 100);\n    \n    const meter = $('audio-meter-fill');\n    if (meter) meter.style.width = level + '%';\n  }, 50);\n}\n\nexport function stopAudioMeter() {\n  if (meterInterval) {\n    clearInterval(meterInterval);\n    meterInterval = null;\n  }\n  if (analyser) {\n    try { analyser.disconnect(); } catch {}\n    analyser = null;\n  }\n}\n\n// Noise profiling\nlet noiseProfile = getNoiseProfile();\n\nexport function startNoiseLearning() {\n  if (!state.localStream) return;\n  \n  noiseProfile.isLearning = true;\n  noiseProfile.learningData = [];\n  \n  const btn = $('learn-noise');\n  if (btn) { btn.textContent = 'ÌïôÏäµÏ§ë...'; btn.disabled = true; }\n  \n  const ctx = getSharedAudioContext();\n  const analyser = ctx.createAnalyser();\n  analyser.fftSize = 256;\n  analyser.smoothingTimeConstant = 0.3;\n  \n  const source = ctx.createMediaStreamSource(state.localStream);\n  source.connect(analyser);\n  \n  const dataArray = new Uint8Array(analyser.frequencyBinCount);\n  let sampleCount = 0;\n  \n  const collectSample = () => {\n    if (!noiseProfile.isLearning) return;\n    \n    analyser.getByteFrequencyData(dataArray);\n    let sum = 0;\n    for (let i = 0; i < dataArray.length; i++) sum += dataArray[i] * dataArray[i];\n    const rms = Math.sqrt(sum / dataArray.length);\n    const dbLevel = 20 * Math.log10(rms / 255);\n    \n    noiseProfile.learningData.push(dbLevel);\n    sampleCount++;\n    \n    if (sampleCount < 30) {\n      setTimeout(collectSample, 100);\n    } else {\n      finishNoiseLearning(analyser);\n    }\n  };\n  \n  collectSample();\n}\n\nfunction finishNoiseLearning(analyser) {\n  noiseProfile.isLearning = false;\n  \n  if (noiseProfile.learningData.length > 0) {\n    const sorted = noiseProfile.learningData.sort((a, b) => a - b);\n    const median = sorted[Math.floor(sorted.length / 2)];\n    const q75 = sorted[Math.floor(sorted.length * 0.75)];\n    \n    noiseProfile.baselineLevel = median;\n    noiseProfile.adaptiveThreshold = Math.max(median + 10, q75 + 5);\n    \n    setNoiseProfile({ baselineLevel: noiseProfile.baselineLevel, adaptiveThreshold: noiseProfile.adaptiveThreshold });\n    toast(`ÎÖ∏Ïù¥Ï¶à ÌîÑÎ°úÌååÏùº ÌïôÏäµ ÏôÑÎ£å (${Math.round(noiseProfile.baselineLevel)}dB)`, 'success');\n  }\n  \n  const btn = $('learn-noise');\n  if (btn) { btn.textContent = 'ÌïôÏäµ'; btn.disabled = false; }\n  \n  try { analyser.disconnect(); } catch {}\n}\n\nexport function resetNoiseProfile() {\n  noiseProfile = { baselineLevel: -60, adaptiveThreshold: -45, learningData: [], isLearning: false };\n  setNoiseProfile({ baselineLevel: -60, adaptiveThreshold: -45 });\n  toast('ÎÖ∏Ïù¥Ï¶à ÌîÑÎ°úÌååÏùº Î¶¨ÏÖã', 'info');\n}\n\n// Presets\nexport function applyAudioPreset(preset) {\n  if (!preset) return;\n  Object.entries(preset).forEach(([key, value]) => {\n    inputEffects[key] = value;\n    updateInputEffect(key, value);\n    \n    // Update UI sliders\n    const sliderMap = { eqLow: 'eq-low', eqMid: 'eq-mid', eqHigh: 'eq-high', \n                        inputVolume: 'input-volume', compressionRatio: 'compression-ratio' };\n    const el = $(sliderMap[key]);\n    if (el) {\n      el.value = value;\n      if (el.nextElementSibling) {\n        el.nextElementSibling.textContent = key === 'compressionRatio' ? `${value}:1` : \n                                            key === 'inputVolume' ? `${value}%` : `${value}dB`;\n      }\n    }\n  });\n}\n","// Styx - Recording Module\n// Recording, multitrack, export functionality\n\nimport { $, state, log } from './core.js';\nimport { toast } from './ui.js';\n\nlet recordingAudioCtx = null;\nlet multitrackRecorders = new Map();\nlet recordingMarkers = [];\nlet recordingStartTime = 0;\n\nfunction formatTime(ms) {\n  const s = Math.floor(ms / 1000);\n  const m = Math.floor(s / 60);\n  return `${m}:${(s % 60).toString().padStart(2, '0')}`;\n}\n\nfunction downloadTrack(chunks, name) {\n  const blob = new Blob(chunks, { type: 'audio/webm' });\n  const a = document.createElement('a');\n  a.href = URL.createObjectURL(blob);\n  a.download = `styx-${name}.webm`;\n  a.click();\n  URL.revokeObjectURL(a.href);\n}\n\nfunction exportMarkers(filename) {\n  if (recordingMarkers.length === 0) return;\n  const content = recordingMarkers.map(m => `${formatTime(m.time)}\\t${m.label}`).join('\\n');\n  const blob = new Blob([content], { type: 'text/plain' });\n  const a = document.createElement('a');\n  a.href = URL.createObjectURL(blob);\n  a.download = `${filename}_markers.txt`;\n  a.click();\n  URL.revokeObjectURL(a.href);\n}\n\nexport function addRecordingMarker(label = '') {\n  if (!state.isRecording) return;\n  const elapsed = Date.now() - recordingStartTime;\n  const marker = { time: elapsed, label: label || `Marker ${recordingMarkers.length + 1}` };\n  recordingMarkers.push(marker);\n  toast(`ÎßàÏª§ Ï∂îÍ∞Ä: ${formatTime(elapsed)}`, 'info', 1500);\n}\n\nexport function startRecording() {\n  if (state.isRecording) return;\n  \n  const timestamp = new Date().toISOString().slice(0,19).replace(/:/g,'-');\n  recordingMarkers = [];\n  recordingStartTime = Date.now();\n  \n  if (state.multitrackMode) {\n    multitrackRecorders.clear();\n    \n    // Local audio\n    if (state.localStream) {\n      const rec = new MediaRecorder(state.localStream, { mimeType: 'audio/webm' });\n      const chunks = [];\n      rec.ondataavailable = e => { if (e.data.size > 0) chunks.push(e.data); };\n      rec.onstop = () => downloadTrack(chunks, `${timestamp}_${state.currentUser.username}_local`);\n      rec.start();\n      multitrackRecorders.set('local', { recorder: rec, chunks, username: state.currentUser.username });\n    }\n    \n    // Remote peers\n    state.peers.forEach((peer, id) => {\n      if (peer.audioEl?.srcObject) {\n        const rec = new MediaRecorder(peer.audioEl.srcObject, { mimeType: 'audio/webm' });\n        const chunks = [];\n        rec.ondataavailable = e => { if (e.data.size > 0) chunks.push(e.data); };\n        rec.onstop = () => downloadTrack(chunks, `${timestamp}_${peer.username}`);\n        rec.start();\n        multitrackRecorders.set(id, { recorder: rec, chunks, username: peer.username });\n      }\n    });\n    \n    toast(`Î©ÄÌã∞Ìä∏Îûô ÎÖπÏùå ÏãúÏûë (${multitrackRecorders.size}Í∞ú Ìä∏Îûô)`, 'info');\n  } else if (state.loopbackMode) {\n    recordingAudioCtx = new AudioContext();\n    const dest = recordingAudioCtx.createMediaStreamDestination();\n    \n    state.peers.forEach(peer => {\n      if (peer.audioEl?.srcObject) {\n        recordingAudioCtx.createMediaStreamSource(peer.audioEl.srcObject).connect(dest);\n      }\n    });\n    \n    state.recordedChunks = [];\n    state.mediaRecorder = new MediaRecorder(dest.stream, { mimeType: 'audio/webm' });\n    state.mediaRecorder.ondataavailable = e => { if (e.data.size > 0) state.recordedChunks.push(e.data); };\n    state.mediaRecorder.onstop = () => {\n      if (recordingAudioCtx) { recordingAudioCtx.close().catch(() => {}); recordingAudioCtx = null; }\n      downloadTrack(state.recordedChunks, `${timestamp}_loopback`);\n    };\n    state.mediaRecorder.start();\n    toast('Î£®ÌîÑÎ∞± ÎÖπÏùå ÏãúÏûë', 'info');\n  } else {\n    recordingAudioCtx = new AudioContext();\n    const dest = recordingAudioCtx.createMediaStreamDestination();\n    \n    if (state.localStream) {\n      recordingAudioCtx.createMediaStreamSource(state.localStream).connect(dest);\n    }\n    state.peers.forEach(peer => {\n      if (peer.audioEl?.srcObject) {\n        recordingAudioCtx.createMediaStreamSource(peer.audioEl.srcObject).connect(dest);\n      }\n    });\n    \n    state.recordedChunks = [];\n    state.mediaRecorder = new MediaRecorder(dest.stream, { mimeType: 'audio/webm' });\n    state.mediaRecorder.ondataavailable = e => { if (e.data.size > 0) state.recordedChunks.push(e.data); };\n    state.mediaRecorder.onstop = () => {\n      if (recordingAudioCtx) { recordingAudioCtx.close().catch(() => {}); recordingAudioCtx = null; }\n      downloadTrack(state.recordedChunks, `${timestamp}_mix`);\n    };\n    state.mediaRecorder.start();\n    toast('ÎÖπÏùå ÏãúÏûë', 'info');\n  }\n  \n  state.isRecording = true;\n  updateRecordingUI(true);\n}\n\nexport function stopRecording() {\n  if (!state.isRecording) return;\n  \n  const timestamp = new Date().toISOString().slice(0,19).replace(/:/g,'-');\n  \n  if (state.multitrackMode && multitrackRecorders.size > 0) {\n    multitrackRecorders.forEach(({ recorder }) => recorder.stop());\n    multitrackRecorders.clear();\n    toast('Î©ÄÌã∞Ìä∏Îûô ÎÖπÏùå ÏôÑÎ£å', 'success');\n  } else if (state.mediaRecorder) {\n    state.mediaRecorder.stop();\n    toast('ÎÖπÏùå ÏôÑÎ£å', 'success');\n  }\n  \n  if (recordingMarkers.length > 0) {\n    exportMarkers(`styx-${timestamp}`);\n  }\n  \n  state.isRecording = false;\n  updateRecordingUI(false);\n}\n\nexport function toggleRecording() {\n  state.isRecording ? stopRecording() : startRecording();\n}\n\nexport function cleanupRecording() {\n  if (state.isRecording) {\n    if (state.multitrackMode) {\n      multitrackRecorders.forEach(({ recorder }) => { try { recorder.stop(); } catch {} });\n      multitrackRecorders.clear();\n    } else if (state.mediaRecorder) {\n      state.mediaRecorder.stop();\n    }\n  }\n  if (recordingAudioCtx) { recordingAudioCtx.close().catch(() => {}); recordingAudioCtx = null; }\n  state.isRecording = false;\n}\n\nfunction updateRecordingUI(recording) {\n  const btn = $('recordBtn');\n  if (btn) {\n    btn.textContent = recording ? '‚èπÔ∏è ÎÖπÏùå Ï§ë' : '‚è∫Ô∏è ÎÖπÏùå';\n    btn.classList.toggle('recording', recording);\n  }\n}\n\n// Click track export\nexport function exportClickTrack(bpm, bars = 4) {\n  const sampleRate = 48000;\n  const beatDuration = 60 / bpm;\n  const totalBeats = bars * 4;\n  const totalSamples = Math.ceil(totalBeats * beatDuration * sampleRate);\n  \n  const ctx = new OfflineAudioContext(1, totalSamples, sampleRate);\n  \n  for (let i = 0; i < totalBeats; i++) {\n    const osc = ctx.createOscillator();\n    const gain = ctx.createGain();\n    osc.frequency.value = (i % 4 === 0) ? 1000 : 800;\n    gain.gain.value = 0.5;\n    osc.connect(gain);\n    gain.connect(ctx.destination);\n    \n    const startTime = i * beatDuration;\n    osc.start(startTime);\n    osc.stop(startTime + 0.05);\n  }\n  \n  ctx.startRendering().then(buffer => {\n    const wav = audioBufferToWav(buffer);\n    const blob = new Blob([wav], { type: 'audio/wav' });\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = `click-${bpm}bpm-${bars}bars.wav`;\n    a.click();\n    URL.revokeObjectURL(a.href);\n    toast('ÌÅ¥Î¶≠ Ìä∏Îûô ÎÇ¥Î≥¥ÎÇ¥Í∏∞ ÏôÑÎ£å', 'success');\n  });\n}\n\nfunction audioBufferToWav(buffer) {\n  const numChannels = buffer.numberOfChannels;\n  const sampleRate = buffer.sampleRate;\n  const format = 1;\n  const bitDepth = 16;\n  const bytesPerSample = bitDepth / 8;\n  const blockAlign = numChannels * bytesPerSample;\n  const dataLength = buffer.length * blockAlign;\n  const bufferLength = 44 + dataLength;\n  const arrayBuffer = new ArrayBuffer(bufferLength);\n  const view = new DataView(arrayBuffer);\n  \n  const writeString = (offset, str) => {\n    for (let i = 0; i < str.length; i++) view.setUint8(offset + i, str.charCodeAt(i));\n  };\n  \n  writeString(0, 'RIFF');\n  view.setUint32(4, bufferLength - 8, true);\n  writeString(8, 'WAVE');\n  writeString(12, 'fmt ');\n  view.setUint32(16, 16, true);\n  view.setUint16(20, format, true);\n  view.setUint16(22, numChannels, true);\n  view.setUint32(24, sampleRate, true);\n  view.setUint32(28, sampleRate * blockAlign, true);\n  view.setUint16(32, blockAlign, true);\n  view.setUint16(34, bitDepth, true);\n  writeString(36, 'data');\n  view.setUint32(40, dataLength, true);\n  \n  const channelData = buffer.getChannelData(0);\n  let offset = 44;\n  for (let i = 0; i < buffer.length; i++) {\n    const sample = Math.max(-1, Math.min(1, channelData[i]));\n    view.setInt16(offset, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);\n    offset += 2;\n  }\n  \n  return arrayBuffer;\n}\n","// Styx - Network Module\n// Socket.io, WebRTC, UDP/TCP handling\n\nimport { $, state, log, serverUrl, actuallyTauri, tauriInvoke } from './core.js';\nimport { toast, showReconnectProgress, updateReconnectProgress, hideReconnectProgress } from './ui.js';\n\n// Socket.io connection\nexport const socket = io(serverUrl, { \n  reconnection: true, \n  reconnectionDelay: 1000, \n  reconnectionAttempts: 10 \n});\n\n// Reconnection handlers\nsocket.io.on('reconnect_attempt', (attempt) => showReconnectProgress(attempt));\nsocket.io.on('reconnect_error', () => updateReconnectProgress());\nsocket.io.on('reconnect_failed', () => {\n  hideReconnectProgress();\n  toast('ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïã§Ìå® - ÌéòÏù¥ÏßÄÎ•º ÏÉàÎ°úÍ≥†Ïπ®Ìï¥Ï£ºÏÑ∏Ïöî', 'error', 10000);\n});\n\nsocket.on('connect', () => {\n  log('Socket connected');\n  hideReconnectProgress();\n});\n\nsocket.on('disconnect', (reason) => {\n  log('Socket disconnected:', reason);\n  if (reason === 'io server disconnect') {\n    socket.connect();\n  }\n});\n\n// WebRTC configuration\nexport let rtcConfig = {\n  iceServers: [\n    { urls: 'stun:stun.l.google.com:19302' },\n    { urls: 'stun:stun1.l.google.com:19302' },\n  ],\n  iceCandidatePoolSize: 10,\n  bundlePolicy: 'max-bundle',\n  rtcpMuxPolicy: 'require',\n};\n\n// Update TURN credentials\nexport function updateTurnCredentials(credentials) {\n  if (!credentials) return;\n  rtcConfig.iceServers = [\n    { urls: 'stun:stun.l.google.com:19302' },\n    { urls: 'stun:stun1.l.google.com:19302' },\n    {\n      urls: credentials.urls,\n      username: credentials.username,\n      credential: credentials.credential,\n    }\n  ];\n  log('TURN credentials updated');\n}\n\n// NAT detection\nexport async function detectNatType() {\n  if (!actuallyTauri || !tauriInvoke) return { nat_type: 'Unknown', public_addr: '' };\n  try {\n    return await tauriInvoke('detect_nat');\n  } catch (e) {\n    log('NAT detection failed:', e);\n    return { nat_type: 'Unknown', public_addr: '' };\n  }\n}\n\n// P2P connection attempt\nexport async function attemptP2P(peerAddr) {\n  if (!actuallyTauri || !tauriInvoke) return false;\n  try {\n    return await tauriInvoke('attempt_p2p', { peerAddr });\n  } catch (e) {\n    log('P2P attempt failed:', e);\n    return false;\n  }\n}\n\n// UDP mode (Tauri only)\nlet udpPort = null;\n\nexport async function startUdpMode(relayHost, relayPort, sessionId) {\n  if (!actuallyTauri || !tauriInvoke) {\n    toast('UDP Î™®ÎìúÎäî Îç∞Ïä§ÌÅ¨ÌÜ± Ïï±ÏóêÏÑúÎßå ÏÇ¨Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§', 'warning');\n    return false;\n  }\n  \n  try {\n    udpPort = await tauriInvoke('udp_bind', { port: 0 });\n    log('UDP bound to port:', udpPort);\n    \n    await tauriInvoke('udp_set_relay', { host: relayHost, port: relayPort, sessionId });\n    await tauriInvoke('udp_start_relay_stream');\n    \n    toast('UDP Ïò§ÎîîÏò§ Ïä§Ìä∏Î¶º ÏãúÏûë', 'success');\n    return true;\n  } catch (e) {\n    log('UDP start failed:', e);\n    toast('UDP ÏãúÏûë Ïã§Ìå®: ' + e, 'error');\n    return false;\n  }\n}\n\nexport async function stopUdpMode() {\n  if (!actuallyTauri || !tauriInvoke) return;\n  try {\n    await tauriInvoke('udp_stop_stream');\n    udpPort = null;\n  } catch (e) {\n    log('UDP stop error:', e);\n  }\n}\n\nexport async function setUdpMuted(muted) {\n  if (!actuallyTauri || !tauriInvoke) return;\n  try {\n    await tauriInvoke('udp_set_muted', { muted });\n  } catch (e) {\n    log('UDP mute error:', e);\n  }\n}\n\n// UDP stats\nexport async function getUdpStats() {\n  if (!actuallyTauri || !tauriInvoke) return null;\n  try {\n    return await tauriInvoke('get_udp_stats');\n  } catch (e) {\n    return null;\n  }\n}\n\n// Latency measurement\nexport async function measureRelayLatency() {\n  if (!actuallyTauri || !tauriInvoke) return null;\n  try {\n    return await tauriInvoke('measure_relay_latency');\n  } catch (e) {\n    return null;\n  }\n}\n\n// Bitrate control\nexport async function setBitrate(kbps) {\n  if (!actuallyTauri || !tauriInvoke) return;\n  try {\n    await tauriInvoke('set_bitrate', { bitrateKbps: kbps });\n  } catch (e) {\n    log('Bitrate set error:', e);\n  }\n}\n\n// Connection quality assessment\nexport function getQualityGrade(latency, packetLoss, jitter) {\n  if (latency < 50 && packetLoss < 1 && jitter < 10) return 'excellent';\n  if (latency < 100 && packetLoss < 3 && jitter < 20) return 'good';\n  if (latency < 200 && packetLoss < 5 && jitter < 40) return 'fair';\n  return 'poor';\n}\n\n// SDP optimization for Opus\nexport function optimizeOpusSdp(sdp, mode = 'balanced') {\n  const modes = {\n    'low-latency': { maxaveragebitrate: 64000, stereo: 0, useinbandfec: 0, usedtx: 1, maxptime: 10 },\n    'balanced': { maxaveragebitrate: 96000, stereo: 1, useinbandfec: 1, usedtx: 0, maxptime: 20 },\n    'high-quality': { maxaveragebitrate: 128000, stereo: 1, useinbandfec: 1, usedtx: 0, maxptime: 40 },\n  };\n  \n  const config = modes[mode] || modes.balanced;\n  const fmtpLine = `a=fmtp:111 minptime=10;maxptime=${config.maxptime};useinbandfec=${config.useinbandfec};usedtx=${config.usedtx};stereo=${config.stereo};maxaveragebitrate=${config.maxaveragebitrate}`;\n  \n  return sdp.replace(/a=fmtp:111[^\\r\\n]*/g, fmtpLine);\n}\n","// Styx Client Entry Point\n// This file imports modules and the legacy app.js\n\n// Import modules (will be tree-shaken if unused)\nimport * as core from './modules/core.js';\nimport * as ui from './modules/ui.js';\nimport * as settings from './modules/settings.js';\nimport * as audio from './modules/audio.js';\nimport * as recording from './modules/recording.js';\nimport * as network from './modules/network.js';\n\n// Expose modules globally for gradual migration\nwindow.styxModules = { core, ui, settings, audio, recording, network };\n\n// Legacy app.js will be loaded via script tag (non-module)\n// Once migration is complete, we can import it here instead\n"],"names":["settings","noiseProfile","analyser","_a","recording","offset"],"mappings":"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"}