# Styx 사용자 매뉴얼

> HADES 그룹을 위한 실시간 오디오 협업 플랫폼

---

## 목차
1. [시스템 개요](#시스템-개요)
2. [시작하기](#시작하기)
3. [로비 기능](#로비-기능)
4. [방 기능](#방-기능)
5. [오디오 설정](#오디오-설정)
6. [고급 기능](#고급-기능)
7. [문제 해결](#문제-해결)

---

## 시스템 개요

### 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         Styx 시스템                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   ┌──────────┐         ┌──────────────┐         ┌──────────┐   │
│   │  웹 앱   │◄───────►│   서버       │◄───────►│  웹 앱   │   │
│   │(브라우저)│         │ (Node.js)    │         │(브라우저)│   │
│   └────┬─────┘         └──────────────┘         └────┬─────┘   │
│        │                      │                       │         │
│        │    WebRTC P2P 오디오 연결                    │         │
│        └──────────────────────┴───────────────────────┘         │
│                                                                  │
│   ┌──────────────────────────────────────────────────────────┐  │
│   │                    데스크톱 앱 (Tauri)                    │  │
│   │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐   │  │
│   │  │ WebRTC 모드 │ or │  UDP 모드   │    │ 저지연 오디오│   │  │
│   │  │  (P2P)      │    │ (커스텀)    │    │   처리      │   │  │
│   │  └─────────────┘    └─────────────┘    └─────────────┘   │  │
│   └──────────────────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 주요 특징
- **P2P 오디오**: 서버를 거치지 않고 사용자 간 직접 연결
- **저지연**: 실시간 음악 협업을 위한 최적화
- **크로스 플랫폼**: 웹 브라우저 + Windows/Mac 데스크톱 앱
- **동기화**: 메트로놈 및 지연 보상 기능

---

## 시작하기

### 접속 방법
1. **웹**: https://3-39-223-2.nip.io 접속
2. **데스크톱 앱**: Styx 앱 실행

### 회원가입
1. "회원가입" 탭 클릭
2. 사용자명 (2-20자, 영문/숫자/한글/_) 입력
3. 비밀번호 (4-50자) 입력
4. "가입 요청" 클릭
5. **관리자 승인 후 로그인 가능**

### 로그인
1. 사용자명과 비밀번호 입력
2. "로그인" 클릭
3. 로비로 이동

---

## 로비 기능

### 프로필
- **아바타 변경**: 프로필 이미지 클릭 → 이미지 선택 (2MB 이하)
- **로그아웃**: 우측 상단 로그아웃 버튼

### 오디오 장치 설정
| 설정 | 설명 |
|------|------|
| 입력 장치 | 마이크 선택 |
| 출력 장치 | 스피커/헤드폰 선택 |
| 마이크 테스트 | 입력 레벨 확인 |

### 방 목록
- 활성화된 방 목록 표시
- 🔒 아이콘: 비밀번호 있는 방
- 👤 숫자: 현재 인원 / 최대 8명
- ✕ 버튼: 방 닫기 (방장/관리자만)

### 방 만들기
1. "방 만들기" 버튼 클릭
2. 방 이름 입력 (최대 30자)
3. 비밀번호 설정 (선택)
4. "만들기" 클릭

---

## 방 기능

### 기본 컨트롤
| 버튼 | 기능 |
|------|------|
| 🎤 / 🔇 | 마이크 음소거 토글 |
| 📋 | 초대 링크 복사 |
| ⏺️ | 녹음 시작/중지 |
| 🚪 | 방 나가기 |
| ❌ | 방 닫기 (방장/관리자) |

### 채팅
- 우측 채팅창에서 텍스트 메시지 전송
- Enter 키로 전송

### 메트로놈
1. BPM 입력 (30-300)
2. ▶️ 버튼으로 시작
3. **모든 사용자에게 동기화됨**

### 사용자 카드
각 참가자 카드에 표시되는 정보:
- 아바타 및 사용자명
- 연결 상태 (연결중/연결됨)
- 품질 등급 (좋음/보통/불안정)
- 지연 시간 (ms)
- 패킷 손실률 (%)
- 볼륨 슬라이더

---

## 오디오 설정

### 방 툴바 옵션

| 옵션 | 설명 | 권장 |
|------|------|------|
| **PTT** | Push-to-Talk 모드 (Space 키) | 노이즈 환경 |
| **VAD** | 음성 활동 감지 (말할 때만 표시) | 기본 ON |
| **자동 품질** | 네트워크 상태에 따라 비트레이트 조절 | 기본 ON |
| **덕킹** | 다른 사람 말할 때 볼륨 자동 감소 | 선택 |
| **지연 보상** | 모든 사용자 지연 시간 동기화 | 음악 협업 시 |

### 지터 버퍼
- 범위: 50ms ~ 200ms
- **낮음 (50ms)**: 지연 최소화, 끊김 가능성
- **높음 (200ms)**: 안정적, 지연 증가
- 권장: 100ms (기본값)

### 오디오 모드 (로비 설정)
| 모드 | 비트레이트 | 용도 |
|------|-----------|------|
| 🎤 음성 | 32kbps | 일반 대화 |
| 🎵 음악 | 128kbps | 악기/음악 |

---

## 고급 기능

### 지연 보상 모드
음악 협업 시 모든 참가자가 동시에 소리를 듣도록 동기화합니다.

**작동 원리:**
1. 각 사용자의 네트워크 지연 측정
2. 가장 느린 사용자 기준으로 설정
3. 빠른 사용자에게 인위적 딜레이 추가
4. 결과: 모든 사용자가 동일한 타이밍에 오디오 수신

**예시:**
```
사용자 A: 50ms  → +100ms 딜레이 → 150ms
사용자 B: 100ms → +50ms 딜레이  → 150ms
사용자 C: 150ms → 딜레이 없음   → 150ms
```

### 데스크톱 앱 전용 기능
- **UDP 모드**: WebRTC보다 낮은 지연
- **오디오 드라이버 선택**: WASAPI, ASIO 등
- **연결 테스트**: STUN/TURN 서버 연결 확인

### 관리자 기능
- 가입 요청 승인/거절
- 사용자 삭제
- 모든 방 닫기 권한

---

## 문제 해결

### 연결 안 됨
1. 브라우저 새로고침
2. 방 재입장
3. 다른 브라우저 시도 (Chrome 권장)

### 소리가 안 들림
1. 출력 장치 확인
2. 상대방 볼륨 슬라이더 확인
3. 브라우저 오디오 권한 확인

### 소리가 끊김
1. 지터 버퍼 증가 (150-200ms)
2. 자동 품질 활성화
3. 다른 네트워크 시도

### 지연이 너무 큼
1. 지터 버퍼 감소 (50-100ms)
2. 유선 인터넷 사용
3. 데스크톱 앱 UDP 모드 시도

### 에코/피드백
1. 헤드폰 사용 권장
2. 에코 제거 활성화 (로비 설정)
3. 마이크와 스피커 거리 확보

---

## 단축키

| 키 | 기능 |
|----|------|
| Space | PTT 모드에서 말하기 |
| Enter | 채팅 메시지 전송 |
| Esc | 모달 닫기 |

---

## 기술 사양

| 항목 | 사양 |
|------|------|
| 오디오 코덱 | Opus |
| 샘플레이트 | 48kHz |
| 채널 | 모노 |
| 비트레이트 | 32-128kbps |
| 최대 인원 | 8명/방 |
| 프로토콜 | WebRTC (P2P), WebSocket (시그널링) |

---

## 지원

문제가 지속되면 관리자에게 문의하세요.

**버전**: 1.0.0  
**최종 업데이트**: 2024년 12월
