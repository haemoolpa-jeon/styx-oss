# 🎵 Styx - HADES 전용 실시간 오디오 협업 플랫폼

## Styx가 뭔가요?

Styx는 우리 HADES 멤버들이 **온라인에서 함께 음악을 연주**할 수 있도록 만든 프로그램입니다. 
마치 같은 방에서 합주하는 것처럼, 인터넷을 통해 실시간으로 서로의 소리를 들으며 연주할 수 있어요.

**특히 보컬 연습과 협업에 최적화**되어 있습니다. 악기 합주도 가능하지만, 
우리 그룹 특성상 보컬 위주의 실시간 소통에 초점을 맞춰 개발했어요.

---

## 왜 직접 만들었나요?

### 기존 서비스들의 문제점

**SyncRoom (야마하)**
- 일본 서버 위주라 한국에서 지연이 큼
- 무료 버전은 기능 제한
- 불특정 다수를 위한 서비스라 트래픽 경쟁
- 커스터마이징 불가능

**SonoBus**
- 설정이 복잡함
- 서버를 직접 운영해야 함
- UI가 직관적이지 않음
- 안정성 이슈가 종종 발생

**Discord / Zoom**
- 음악용이 아니라 지연이 100ms 이상
- 음질 압축이 심함
- 합주에는 사실상 사용 불가

### Styx의 핵심 장점

#### 1. 🎯 소규모 전용 = 쾌적한 환경

| 항목 | 공개 서비스 | Styx |
|------|------------|------|
| 사용자 수 | 수천~수만 명 | **8명 (HADES 전용)** |
| 서버 부하 | 높음 | **거의 없음** |
| 트래픽 경쟁 | 있음 | **없음** |
| 대역폭 | 나눠 씀 | **우리만 씀** |

**왜 이게 중요한가요?**
- 공개 서비스는 수많은 사용자가 동시에 접속해서 서버와 네트워크를 나눠 씁니다
- Styx는 **우리 8명만 사용**하니까 항상 최적의 환경을 유지할 수 있어요
- 피크 타임에도 품질 저하 없음!

#### 2. ⚡ 지연 시간 비교

| 서비스 | 일반적인 지연 | 비고 |
|--------|-------------|------|
| Discord | 150~300ms | 대화용, 합주 불가 |
| Zoom | 100~200ms | 회의용 |
| SyncRoom | 50~100ms | 서버 위치에 따라 다름 |
| **Styx (WebRTC)** | **40~80ms** | 웹 버전 |
| **Styx (UDP)** | **20~40ms** | 데스크톱 앱 |

> 💡 **참고**: 사람이 "동시에 연주한다"고 느끼려면 지연이 **30ms 이하**여야 합니다.
> 50ms까지는 약간의 적응으로 합주 가능, 100ms 이상은 사실상 불가능해요.

#### 3. 🎛️ 세밀한 제어 옵션

Styx는 **지연, 성능, 안정성** 사이의 균형을 사용자가 직접 조절할 수 있습니다.

**오디오 모드**
| 모드 | 특징 | 추천 상황 |
|------|------|----------|
| 음성 모드 | 에코/노이즈 제거 ON, 낮은 대역폭 | 보컬 연습, 대화 |
| 음악 모드 | 에코/노이즈 제거 OFF, 높은 음질 | 악기 합주, 녹음 |

**안정성 vs 지연 트레이드오프**
| 설정 | 효과 |
|------|------|
| 지터 버퍼 크기 | 크게 → 안정적이지만 지연 증가 / 작게 → 빠르지만 끊김 가능 |
| 자동 적응 | 네트워크 상태에 따라 자동 조절 |
| 연결 품질 표시 | 실시간으로 상태 확인 가능 |

**개인별 설정**
- 에코 제거 ON/OFF
- 노이즈 제거 ON/OFF  
- 자동 게인 컨트롤
- PTT (Push-to-Talk) 모드
- 개인별 볼륨 조절

#### 4. 🔒 프라이빗 환경

- **화이트리스트 인증**: 승인된 멤버만 접속 가능
- **방 비밀번호**: 추가 보안 레이어
- **외부 노출 없음**: 우리끼리만 사용하는 서버

---

## 현재 완성된 기능들

### 🌐 웹 버전 (v2.3) - 지금 바로 사용 가능!

**기본 기능**
- 방 만들기 / 입장 (비밀번호 설정 가능)
- 실시간 음성 통화 (WebRTC)
- 채팅
- 메트로놈 동기화 (모두가 같은 박자!)

**오디오 설정**
- 마이크/스피커 선택
- 개인별 볼륨 조절
- 음성 모드 / 음악 모드 전환
- 에코 제거, 노이즈 제거 ON/OFF
- PTT (Push-to-Talk) 모드
- VAD (음성 감지) - 말할 때만 전송

**안정성 기능**
- 지터 버퍼 크기 조절 (50~300ms)
- 자동 적응 모드
- 연결 품질 대시보드
- 핑 그래프 (실시간 지연 시각화)
- 오프라인 감지 및 자동 재연결
- 연결 테스트 기능

**편의 기능**
- 다크/라이트 테마
- 세션 녹음
- 초대 링크 생성
- 오디오 덕킹 (다른 사람 말할 때 자동 볼륨 조절)

### 🖥️ 데스크톱 앱 (개발 중)

웹 버전보다 **더 낮은 지연**을 위해 데스크톱 앱을 개발 중입니다.

**왜 데스크톱 앱이 더 빠른가요?**

```
웹 버전:
마이크 → [브라우저 처리] → WebRTC → 인터넷 → WebRTC → [브라우저 처리] → 스피커
              ↑ 지연 발생                              ↑ 지연 발생

데스크톱 앱:
마이크 → [ASIO 직접 접근] → UDP → 인터넷 → UDP → [ASIO 직접 접근] → 스피커
              ↑ 최소 지연                           ↑ 최소 지연
```

**데스크톱 앱 추가 기능**
- ASIO 드라이버 지원 (오디오 인터페이스 사용자용)
- Custom UDP 모드 (WebRTC보다 빠름)
- Opus 코덱 (고음질 + 저대역폭)
- 시스템 트레이 상주
- 글로벌 단축키 (Ctrl+Shift+M = 음소거)

---

## 기술적인 이야기 (관심 있는 분들만)

### 아키텍처

```
┌─────────────────────────────────────────────────────┐
│                    Styx 서버                         │
│  - 사용자 인증 (화이트리스트)                         │
│  - 방 관리                                           │
│  - 시그널링 (누가 어디 있는지 알려줌)                  │
│  - 채팅, 메트로놈 동기화                              │
│  ※ 오디오 데이터는 서버를 거치지 않음!                │
└─────────────────────────────────────────────────────┘
                         │
         ┌───────────────┼───────────────┐
         │               │               │
         ▼               ▼               ▼
    ┌─────────┐    ┌─────────┐    ┌─────────┐
    │ 멤버 A  │◄══►│ 멤버 B  │◄══►│ 멤버 C  │
    └─────────┘    └─────────┘    └─────────┘
         │               │               │
         └═══════════════╧═══════════════┘
                  P2P 오디오 (직접 연결)
```

**핵심 포인트**: 
- 오디오는 서버를 거치지 않고 **멤버끼리 직접** 주고받습니다
- 서버는 "누가 방에 있는지"만 알려주는 역할
- P2P 방식이라 서버 부하가 거의 없고, 지연도 최소화

### 사용 기술

| 구분 | 기술 | 왜 선택했나 |
|------|------|------------|
| 웹 프론트엔드 | 순수 HTML/CSS/JS | 가볍고 빠른 로딩 |
| 웹 오디오 | WebRTC | 브라우저 표준, 별도 설치 불필요 |
| 서버 | Node.js + Socket.IO | 실시간 이벤트에 최적화 |
| 데스크톱 앱 | Tauri + Rust | Electron보다 10배 가볍고 빠름 |
| 오디오 코덱 | Opus | 음악/음성 모두에 최적화 |
| 저지연 오디오 | ASIO + cpal | 전문 오디오 드라이버 지원 |

---

## 앞으로의 계획

### 단기 (1~2주)
- [ ] Windows 데스크톱 앱 첫 테스트 버전
- [ ] STUN 서버 연동 (NAT 뒤에서도 연결)
- [ ] 연결 품질 실시간 모니터링 개선

### 중기 (1개월)
- [ ] Mac 버전 지원
- [ ] 오디오 인터페이스 선택 UI
- [ ] 지연 시간 측정 및 표시 (ms 단위)

### 장기 (필요시)
- [ ] 모바일 앱 (가능할지 검토 필요)
- [ ] 다중 채널 (파트별 분리)
- [ ] 세션 녹음 개선

---

## 어떻게 사용하나요?

### 웹 버전 (지금 바로!)

1. 서버 주소로 접속
2. 회원가입 → 관리자 승인 대기
3. 로그인 → 방 만들기 or 입장
4. 마이크 허용 → 연습 시작!

**추천 설정 (보컬 연습용)**
- 오디오 모드: 음성 모드
- 에코 제거: ON
- 노이즈 제거: ON
- 지터 버퍼: 100ms (기본값)

### 데스크톱 앱 (곧 출시)

1. 설치 파일 다운로드
2. 설치 후 실행
3. 웹 버전과 동일하게 사용
4. 설정에서 "Custom UDP" 모드 선택하면 저지연 모드

---

## 자주 묻는 질문

**Q: 인터넷 속도가 느려도 되나요?**
> 10Mbps 이상이면 충분합니다. 오디오는 생각보다 데이터가 적어요.

**Q: 유선 vs 와이파이?**
> 유선을 강력 추천합니다. 와이파이는 지연 변동이 커서 끊김이 생길 수 있어요.

**Q: 헤드폰 필수인가요?**
> 네, 스피커 사용 시 에코가 발생합니다. 이어폰이라도 꼭 사용해 주세요.

**Q: 오디오 인터페이스가 있으면 더 좋나요?**
> 데스크톱 앱에서 ASIO 드라이버를 사용하면 지연이 더 줄어듭니다.
> 없어도 웹 버전으로 충분히 사용 가능해요.

---

## 피드백 환영합니다!

사용하면서 불편한 점, 추가됐으면 하는 기능, 버그 등 
언제든 말씀해 주세요. **우리가 쓸 프로그램이니까 우리 입맛에 맞게 만들어요!** 🎤✨

---

*Made with ❤️ for HADES*
